<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="index.js"></script>
  <script>
    function startClearKey() {
      const video = document.querySelector('video');

      const assetURL = 'output_frag_encrypted.mp4';
      const videoCodec = 'avc1.42C01E';
      const audioCodec = 'mp4a.40.2';
      const mime = `video/mp4; codecs="${videoCodec}, ${audioCodec}"`;
      const encryption_key = hexToUint8Array('9c61173d2db8939009be4bd689533ade');
      const encryption_kid = hexToUint8Array('a53fcebc83532682766c7d0e012fe92f');

      setMediaKeysClearKey(video, videoCodec, audioCodec, encryption_key);
      setMediaSourceConcatenated(video, assetURL, mime);
    }

    function startSimple() {
      const video = document.querySelector('video');
      // https://dash.akamaized.net/akamai/bbb_30fps/bbb_30fps.mpd
      const assets = [
        {
          urls:
            Array.from({ length: 11 }, (_, idx) =>
              `https://dash.akamaized.net/akamai/bbb_30fps/bbb_30fps_640x360_1000k/bbb_30fps_640x360_1000k_${idx}.m4v`),
          mimeCodec: 'video/mp4; codecs="avc1.64001e"'
        },
        {
          urls:
            Array.from({ length: 11 }, (_, idx) =>
              `https://dash.akamaized.net/akamai/bbb_30fps/bbb_a64k/bbb_a64k_${idx}.m4a`),
          mimeCodec: 'audio/mp4; codecs="mp4a.40.5"'
        }
      ];

      setMediaSource(video, assets);
    }

  </script>
</head>

<body>

  <div>
    <video controls></video>
    <button onclick="startClearKey()">START org.w3.clearkey</button>
    <button onclick="startSimple()">START simple</button>
  </div>

  <p>(CC) Blender Foundation | mango.blender.org</p>
</body>

</html>